<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  
<script id="draw-shader-fs" type="x-shader/x-fragment">
  precision mediump float;
  
  uniform vec2 iResolution;
  uniform vec2 iMouse;
  uniform float iTime;
  // Simple hash function
float hash(float n) {
    return fract(sin(n) * 43758.5453);
}

// 2D noise function
float noise(vec2 p) {
    vec2 i = floor(p);
    vec2 f = fract(p);
    vec2 u = f * f * (3.0 - 2.0 * f);
    return mix(mix(hash(i.x + hash(i.y)), hash(i.x + 1.0 + hash(i.y)), u.x),
               mix(hash(i.x + hash(i.y + 1.0)), hash(i.x + 1.0 + hash(i.y + 1.0)), u.x), u.y);
}

// Mountain range function
float mountainRange(vec2 uv) {
    float mountainHeight = 0.0;
    float frequency = 2.0;
    float amplitude = 0.5;
    for (int i = 0; i < 5; i++) {
        mountainHeight += noise(uv * frequency) * amplitude;
        frequency *= 2.0;
        amplitude *= 0.5;
    }
    return mountainHeight;
}

// Aurora layer function
vec3 auroraLayer(vec2 uv, float speed, float intensity, vec3 color) {
    float t = iTime * speed;
    vec2 scaleXY = vec2(2.0, 2.0);
    vec2 movement = vec2(2.0, -2.0);
    vec2 p = uv * scaleXY + t * movement;
    float n = noise(p + noise(color.xy + p + t));
    
    /*
    float topEdgeSharpness = 0.2; //the smaller this value, the crispier the edge
    float bottomFadeOut = 0.3; //the higher this value, the more solid the aurora appears
    float aurora = smoothstep(0.0, topEdgeSharpness, n - uv.y) * (1.0 - smoothstep(0.0, bottomFadeOut, n - uv.y));
    
    return aurora * intensity * color;
    */
    float aurora = (n - uv.y * 0.6) ;
    
    return color * aurora * intensity * 2.0;
}


// Main image function
void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    vec2 uv = fragCoord / iResolution.xy;
    uv.x *= iResolution.x / iResolution.y;

    // Create multiple aurora layers with varying colors, speeds, and intensities
    vec3 color = vec3(1.0);
    color -= auroraLayer(uv, 0.05, 0.3, vec3(1.0, 0.0, 0.7));
    color -= auroraLayer(uv, 0.1, 0.4, vec3(0.9, 0.5, 0.1));
    color -= auroraLayer(uv, 0.15, 0.3, vec3(0.6, 0.9, 0.2));
    color -= auroraLayer(uv, 0.07, 0.2, vec3(0.2, 0.9, 0.4));
   
    vec3 skyColor1 = vec3(0.2, 0.0, 0.4);
    vec3 skyColor2 = vec3(0.15, 0.2, 0.35);
    // Add a gradient to simulate the night sky
    color += skyColor2 * (1.0 - smoothstep(0.4, 1.0, uv.y));
    color += skyColor1 * (1.0 - smoothstep(0.0, 0.5, uv.y));
    /*
    int numLayers = 5;
    for (int i = 0; i < numLayers; i++) {
        // Calculate the height of the mountain range
        float height = float(numLayers-i) * 0.1 
            * smoothstep(0.9, 0.0, 
                mountainRange(
                    vec2(iTime * 0.03 * (float(i) + 1.0) + float(i) * 4.0, 0.0) 
                    + uv * vec2( 1.0 + float(numLayers - i) * 0.05 , 0.23 )
                )
            );

        // Create the black silhouette of the mountain range
        float mountain = smoothstep(0.0, float(i) * 0.02, height - uv.y);

        // Combine the mountain range and sky
        color = mix(color, skyColor2 * float(numLayers - i)/3.0, mountain);
    }*/

    fragColor = vec4(color, 1.0);
}
  void main() 
  {
      mainImage( gl_FragColor, gl_FragCoord.xy );
  }
  </script>
  
  <script id="draw-shader-vs" type="x-shader/x-vertex">
  attribute vec2 inPos;
  
  void main() 
  {
      gl_Position = vec4(inPos, 0.0, 1.0);
  }
  </script>
  
  <canvas id="ogl-canvas" style="border: none"></canvas>
<script src="./main.js"></script>
</body>
</html>